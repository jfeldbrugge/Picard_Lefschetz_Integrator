<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Job Feldbrugge, Ue-Li Pen and Neil Turok" />
  <title>Picard-Lefschetz integrator</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Picard-Lefschetz integrator</h1>
<p class="author">Job Feldbrugge, Ue-Li Pen and Neil Turok</p>
</header>
<p>Interference is one of the most universal phenomena in nature. In classical physics, the linear superposition of sound waves, surface waves, radio waves, light or gravitational waves all exhibit the same characteristic patterns of constructive and destructive interference. Interference is also fundamental to quantum physics. The basic quantum amplitudes describing particles or fields are most elegantly formulated as path integrals – sums over trajectories weighted by the phase factor <span class="math inline">\(e^{iS/\hbar}\)</span> with <span class="math inline">\(S\)</span> the action and <span class="math inline">\(\hbar\)</span> Planck’s constant. As ubiquitous as interference and interference patterns are, they are generally hard to compute. The oscillatory integrals involved are only conditionally and not absolutely convergent, meaning they converge slowly and artefacts such as dependence on unphysical cutoffs may be hard to avoid. Likewise, if the integrals are performed iteratively, as is often the only practicable method, conditional convergence is in general insufficient to guarantee uniqueness, since the order in which partial integrals are taken can affect the result.</p>
<p>Cauchy’s theorem allows one to transform a computationally fragile and expensive, highly oscillatory integral into an exactly equivalent sum of absolutely and rapidly convergent integrals which can be evaluated in polynomial time. We require only that it is possible to analytically continue the lensing phase, expressed in the integrated coordinates, into the complex domain. Picard-Lefschetz theory is a systematic method to find the optimal deformation of the integration domain. We here describe Picard-Lefschetz theory and provide a numerical implementation of Picard-Lefschetz theory for both one- and two-dimensional integrals accompanying the recent papers <a href="https://arxiv.org/abs/1909.04632">Feldbrugge, Pen, and Turok 2019</a> ….</p>
<figure>
<table align="left" width="100%" id="FIG">
<tr>
<td>
<img src='figures/Lens1_nu=50.png' width=100% />
</td>
<td>
<img src='figures/Lens1_nu=100.png' width=100% />
</td>
<td>
<img src='figures/Lens1_nu=500.png' width=100% />
</td>
</tr>
</table>
<figcaption>
Fig.1 - The frequency pattern of a thin lens with frequency <span class="math inline">\(\nu=50,100\)</span> and <span class="math inline">\(500\)</span>.
</figcaption>
</figure>
<h2 id="picard-lefschetz-theory">Picard-Lefschetz theory</h2>
<p>Consider the oscillatory integral <span class="math display">\[I = \int_{\mathbb{R}^n} e^{i \phi(\boldsymbol{x})}\mathrm{d}\boldsymbol{x},\]</span> with the analytic exponent of the integrand <span class="math inline">\(\phi:\mathbb{R}^n \to \mathbb{C}\)</span>. This integral is generally highly oscillatory and difficult to evaluate. We can improve the properties of the integral by analytically continuing the integrand into the complex plane and continuously deforming the integration domain to the Lefschetz thimble <span class="math inline">\(\mathcal{J} \subset \mathbb{C}^n\)</span> removing the oscillatons, <span class="math display">\[I = \int_{\mathcal{J}} e^{i \phi(\boldsymbol{x})}\mathrm{d}\boldsymbol{x}.\]</span></p>
<p>In order to obtain the Lefschetz thimble, we first express the exponent <span class="math inline">\(i\phi\)</span> in terms of a real and an imaginary part <span class="math display">\[i\phi(\boldsymbol{x}) = h(\boldsymbol{x}) + i H(\boldsymbol{x}).\]</span> Note that <span class="math inline">\(h\)</span>-function determines the magnitude of the integrand. We define the downwards flow <span class="math inline">\(\gamma_\lambda:\mathbb{C}^n\to \mathbb{C}^n\)</span> of the <span class="math inline">\(h\)</span>-function with the differential equation <span class="math display">\[ \frac{\mathrm{d} \gamma_{\lambda}(\boldsymbol{x}_0)}{\mathrm{d}\lambda} = -\nabla h(\gamma_\lambda(\boldsymbol{x}_0)),\]</span> with the boundary condition <span class="math inline">\(\gamma_0(\boldsymbol{x}_0) = \boldsymbol{x}_0 \in \mathbb{C}^n\)</span>. The downward flow defines a continuous deformation of the integration domain <span class="math inline">\(\gamma_\lambda(\mathbb{R}^n),\)</span> from the original domain at <span class="math inline">\(\lambda=0\)</span> to the Lefschetz thimble in the limit <span class="math inline">\(\lambda \to \infty\)</span>, <span class="math display">\[\mathcal{J} =\lim_{\lambda \to \infty} \gamma_\lambda(\mathbb{R}^n).\]</span> Since the thimble <span class="math inline">\(\mathcal{J}\)</span> is a fixed point of the downward flow <span class="math inline">\(\gamma_\lambda\)</span>, it can generally be expressed as a formal sum over steepest descent contours <span class="math display">\[ \mathcal{J} = \sum_i n_i \mathcal{J}_i,\]</span> with <span class="math inline">\(n_i \in \mathbb{Z}\)</span> and <span class="math inline">\(\mathcal{J}_i\)</span> the steepest descent contour of the saddle point <span class="math inline">\(\bar{\boldsymbol{x}}_i \in \mathbb{C}^n\)</span> of the exponent <span class="math inline">\(i\phi.\)</span> Using the Cauchy-Riemann equation, <span class="math inline">\(\nabla h \cdot \nabla H = 0\)</span>, it straigforwardly follows that the imaginary part, <span class="math inline">\(H\)</span>, is constant along the steepest descent contours, <em>i.e.</em>, <span class="math display">\[H(\boldsymbol{x})|_{\mathcal{J}_i} = H(\bar{\boldsymbol{x}}_i),\]</span> removing the oscillations of the integral, <em>i.e.</em>, <span class="math display">\[I = \int_{\mathcal{J}} e^{i\phi(\boldsymbol{x})} \mathrm{d}\boldsymbol{x} = \sum_i n_i e^{i H(\bar{\boldsymbol{x}}_i} \int_{\mathcal{J}_i} e^{h(\boldsymbol{x})}\mathrm{d}\boldsymbol{x}.\]</span> For more details see …</p>
<h6 id="the-fresnel-integral">The Fresnel integral</h6>
<p>The Fresnel integral <span class="math display">\[I_F = \int_{-\infty}^{\infty} e^{i x^2} \mathrm{d}x,\]</span> is a typical example of a conditionally convergent integral as the integrand has unit magnitude, <em>i.e.</em>, <span class="math inline">\(|e^{ix^2}| = 1\)</span>. The integral is often defined in the limit <span class="math inline">\(I_F = \lim_{R\to \infty}I_F(R)\)</span> of the partial integral <span class="math display">\[ I_F(R)  = \int_{-R}^{R} e^{ix^2}\mathrm{d}x.\]</span> In the limit <span class="math inline">\(R \to \infty\)</span>, the partial integral <span class="math inline">\(I_F(R)\)</span> runs over a spiral in the complex plane converging to the point <span class="math inline">\((1+i) \sqrt{\pi / 2}\)</span> (see Fig. 2).</p>
<figure>
<img src="figures/EulerSpiral.gif" width=50% />
<figcaption>
Fig.2 - The partial Fresnel integral <span class="math inline">\(I_F(R)\)</span> (the red point) in the complex plane as a function of <span class="math inline">\(R\)</span> tracing the Euler spiral ending <span class="math inline">\((1+i)\sqrt{\pi/2}\)</span> (the blue point).
</figcaption>
</figure>
<p>This is a well-defined definition of the one-dimensional Fresnel integral. However, it is delicate, inefficient and moreover does not easily generalize to multi-dimensional conditionally convergent integrals where the result can depend on the way we take the limit. Instead, we can analytically extend the exponent into the complex plane <span class="math inline">\(\mathbb{C}\)</span> and use the downward flow <span class="math inline">\(\gamma_\lambda\)</span> <span class="math display">\[\gamma_\lambda(\boldsymbol{x}_0) = [x_{r0} \cosh(2\lambda) + x_{i0} \sinh(2\lambda)] + [x_{r0} \sinh(2\lambda) + x_{i0} \cosh(2\lambda)] i\]</span> with <span class="math inline">\(\text{Re}[x_0]=x_{r0}\)</span> and <span class="math inline">\(\text{Im}[x_0]=x_{i0}\)</span>, to obtain the Lefschetz thimble <span class="math display">\[ \mathcal{J} = \lim_{\lambda\to \infty}\gamma_{\lambda}(\mathbb{R}) = \{(1+i)u | u \in \mathbb{R}\}.\]</span> Along the Lefschetz thimble, the Fresnel integral is tranformed into the Gaussian integral <span class="math display">\[I_F=\int_{\mathcal{J}} e^{i x^2}\mathrm{d}x = (1+i) \int_{-\infty}^{\infty} e^{- 2 u^2}\mathrm{d}u = (1+i)\sqrt{\pi/2},\]</span> removing the oscillations from the definition of the Fresnel integral.</p>
<h2 id="numerical-picard-lefschetz-theory">Numerical Picard-Lefschetz theory</h2>
<p>Picard-Lefschetz theory can be used to efficiently evaluate oscillatory integrals. We here describe a numerical scheme for the downward flow of the integration domain and a Romberg integration scheme along the Lefschetz thimble. We subsequently describe a numerical implementation for one- and two-dimensional integrals.</p>
<h3 id="flowing-the-integration-domain">Flowing the integration domain</h3>
<h3 id="romberg-integration">Romberg integration</h3>
<h3 id="using-the-integrator">Using the integrator</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1"></a><span class="dt">int</span> i = <span class="dv">0</span>;</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="dt">int</span> j = i + <span class="dv">1</span>;</span></code></pre></div>
<pre><code>a = rnorm(10,5,2)
for (i in 1:10) {
print(a[1])
}</code></pre>
<h2 id="applications">Applications</h2>
<p>The Picard-Lefschetz integrator can be applied to a wide range of problems. We here demonstrate the code by showing a couple examples in the lensing by thin lenses in wave optics governed by the Kirchhoff-Fresnel integral <span class="math display">\[\psi(\boldsymbol{\mu}) = \frac{\nu}{2\pi i} \int e^{i \nu \left[(\boldsymbol{x}-\boldsymbol{\mu})^2/2 + \varphi(\boldsymbol{x})\right]} \mathrm{d}\boldsymbol{x}\]</span> with <span class="math inline">\(\boldsymbol{x}\)</span> the position on the lens, <span class="math inline">\(\boldsymbol{\mu}\)</span> the position on the screen, <span class="math inline">\(\nu\)</span> the frequency of the radiation and <span class="math inline">\(\varphi\)</span> the phase variation of the lens. The intensity is given by the magnitude squared of the amplitude <span class="math display">\[I(\boldsymbol{\mu}) = |\psi(\boldsymbol{\mu})|^2.\]</span></p>
<h3 id="one-dimensional-plasma-lens">One-dimensional plasma lens</h3>
<p>Consider the toy model of a one-dimensional lens consisting of a single blob <span class="math display">\[\varphi(x) = \frac{\alpha}{1+x^2}\]</span> with <span class="math inline">\(\alpha\)</span> the strength of the lens. See figure Fig. 3 for an illustration of the flow of the real line <span class="math inline">\(\mathbb{R}\)</span> to the Lefschetz thimble <span class="math inline">\(\mathcal{J}\)</span> for the lens strength <span class="math inline">\(\alpha =2\)</span> at the centre of the lens <span class="math inline">\(\mu=0\)</span>.</p>
<figure>
<img src="figures/1D_Flow.gif" width=50% />
<figcaption>
Fig.3 - The flow of the integration domain to the thimble for the lens strength <span class="math inline">\(\alpha =2\)</span> and <span class="math inline">\(\mu = 0\)</span>.
</figcaption>
</figure>
<p>We can efficiently evaluate the Kirchhoff-Fresnel integral along the numerical representation of the Lefschetz thimble (see Fig. 4 ). For more details see … .</p>
<figure>
<table align="left" width="100%" id="FIG">
<tr>
<td>
<img src='figures/1D_nu=50.png' width=100% />
</td>
<td>
<img src='figures/1D_nu=100.png' width=100% />
</td>
<td>
<img src='figures/1D_nu=500.png' width=100% />
</td>
</tr>
</table>
<figcaption>
Fig.4 - The intensity pattern of the one-dimensional localized lens with the lens strenght <span class="math inline">\(\alpha =2\)</span> for the frequency from left to right <span class="math inline">\(\nu=50,100\)</span> and <span class="math inline">\(500\)</span>.
</figcaption>
</figure>
<h3 id="random-lens">Random lens</h3>
<p>Lensing by a random or turbulent medium can be modelled by assuming that the phase variation <span class="math inline">\(\varphi\)</span> is a realization of a Gaussian random field. See Fig. 5 for an illustration of an interference pattern corresponding to a random lens with the power-law power spectrum <span class="math inline">\(P(\boldsymbol{k}) \propto k^{-1}\)</span>. For more details see… .</p>
<figure>
<table align="left" width="100%" id="FIG">
<tr>
<td>
<img src='figures/Random_nu=50.png' width=100% />
</td>
<td>
<img src='figures/Random_nu=100.png' width=100% />
</td>
<td>
<img src='figures/Random_nu=200.png' width=100% />
</td>
</tr>
<tr>
<td>
<img src='figures/Random_nu=400.png' width=100% />
</td>
<td>
<img src='figures/Random_nu=800.png' width=100% />
</td>
<td>
<img src='figures/Random_nu=1600.png' width=100% />
</td>
</tr>
</table>
<figcaption>
Fig.5 - The intensity pattern due to lensing by a random screen with a power-law power spectrum <span class="math inline">\(P(\boldsymbol{k}) \propto k^{-1}\)</span>. The red curves display the caustics present in the geometric optics limit.
</figcaption>
</figure>
<h3 id="gravitational-lensing">Gravitational lensing</h3>
<p>A gravitational lens consisting of <span class="math inline">\(N\)</span> pointsources positioned at <span class="math inline">\(\boldsymbol{x}_i\)</span> in the thin-lens approximation has a phase variation of the form <span class="math display">\[\varphi(\boldsymbol{x}) =- \sum_{i=1}^N f_i \log(\|\boldsymbol{x} - \boldsymbol{x}_i\|),\]</span> with <span class="math inline">\(f_i\)</span> the relative strength of the lenses (determined by the mass of the sources), with <span class="math inline">\(f_1+\dots + f_N=1\)</span>.</p>
<h4 id="single-gravitational-lens-with-a-shear-term">Single gravitational lens with a shear term</h4>
<p>We also consider a single gravitational lens with a shear field caused by an external source with the phase variation <span class="math display">\[\varphi(\boldsymbol{x}) = - \log(\|\boldsymbol{x}\|) + \frac{1}{2}\gamma (x^2 - y^2)\]</span> with <span class="math inline">\(\boldsymbol{x}=(x,y)\)</span> and the shear <span class="math inline">\(0\leq \gamma \leq 1\)</span> generated by a nearby star of the host galaxy. The corresponding intensity pattern for a mild shear <span class="math inline">\(\gamma=0.2\)</span> for the frequencies <span class="math inline">\(\nu=25,50,75\)</span> is illustrated in figure Fig. 6. For details see …. .</p>
<figure>
<table align="left" width="100%" id="FIG">
<tr>
<td>
<img src='figures/SingleLens+Shear_nu=25.png' width=100% />
</td>
<td>
<img src='figures/SingleLens+Shear_nu=50.png' width=100% />
</td>
<td>
<img src='figures/SingleLens+Shear_nu=75.png' width=100% />
</td>
</tr>
</table>
<figcaption>
Fig.6 - The lensing of a single gravitational lens with shear <span class="math inline">\(\gamma =0.2\)</span> for the frequencies <span class="math inline">\(\nu=25,50,75\)</span>.
</figcaption>
</figure>
<h4 id="binary-gravitational-lens">Binary gravitational lens</h4>
<p>In figure Fig. 7 shows the interference pattern of a binary lens system, with the phase variation <span class="math display">\[\varphi(\boldsymbol{x}) = - f_1 \log(\|\boldsymbol{x} - \boldsymbol{r}\|) - f_2 \log(\|\boldsymbol{x} + \boldsymbol{r}\|),\]</span> with <span class="math inline">\(f_1=1/3\)</span> and <span class="math inline">\(f_2=2/3\)</span> and <span class="math inline">\(\boldsymbol{r} = (0,1/2)\)</span> in units of the Einstein radius with <span class="math inline">\(\nu=50\)</span>. For more details see… .</p>
<figure>
<table align="left" width="100%" id="FIG">
<tr>
<td>
<img src='figures/Binary_Geometric.png' width=100% />
</td>
<td>
<img src='figures/Binary_Wave_nu=25.png' width=100% />
</td>
<td>
<img src='figures/Binary_Wave_nu=50.png' width=100% />
</td>
</tr>
</table>
<figcaption>
Fig.7 - The intensity pattern of a binary gravitational lens with <span class="math inline">\(f_1=1/3,f_2=2/3\)</span> seperated by an Einstein radius, <span class="math inline">\(\boldsymbol{r}=(0,1/2)\)</span> for the frequency <span class="math inline">\(\nu=25\)</span> and <span class="math inline">\(50\)</span>. The left panel is the intensity in geometric optics. The central and right panel is the interference pattern in wave optics for the frequency <span class="math inline">\(\nu=25\)</span> and <span class="math inline">\(50\)</span>.
</figcaption>
</figure>
</body>
</html>
